# 블록체인에서의 해시 (Hash)

## 1. 블록체인과 해시의 관계
- **블록체인**은 데이터를 안전하고 신뢰성 있게 저장하기 위해 **해시 알고리즘**을 핵심 기술로 사용합니다.
- 해시는 블록체인의 무결성과 보안을 유지하는 데 중요한 역할을 합니다.
- 블록체인에서 해시 값은 다음과 같은 주요 용도로 사용됩니다:
    - **블록 간 연결**: 각 블록은 이전 블록의 해시를 포함하여 체인 형태를 만듦.
    - **데이터 무결성 보장**: 블록 내 데이터가 변경되면 해당 블록의 해시 값이 바뀌어 체인이 깨짐.
    - **작업 증명(Proof of Work)**: 새로운 블록을 추가하기 위해 해시 계산을 활용.

---

## 2. 블록체인에서 해시의 동작 원리

### 블록의 구조
블록은 다음과 같은 데이터로 구성됩니다:
- **블록 헤더(Block Header)**:
    - 이전 블록의 해시 (Previous Hash)
    - 현재 블록의 데이터 해시 (Merkle Root)
    - 타임스탬프
    - 난이도 (Difficulty)
    - 논스 (Nonce)
- **블록 데이터(Block Data)**:
    - 거래 내역 (Transactions)

블록의 해시는 **블록 헤더 전체를 입력**으로 하여 계산됩니다.

### 블록 생성 및 연결
1. **새로운 블록 생성**:
    - 새 블록의 데이터와 헤더를 결합하여 해시를 계산.
    - 해시 값이 블록체인의 난이도 조건을 만족해야 함(예: 특정 개수의 앞자리 0이 있어야 함).
    - 이를 위해 **Nonce(임의 값)**를 조정하며 해시 값을 반복 계산.

2. **블록 간 연결**:
    - 새 블록은 이전 블록의 해시 값을 포함.
    - 이전 블록의 데이터가 변경되면, 해당 블록의 해시가 달라지고 체인이 무효화됨.

---

## 3. 블록체인에서 해시의 주요 역할

### 1) 데이터 무결성 보장
- 블록 내 데이터가 변경되면 해당 블록의 해시 값이 바뀜.
- 변경된 해시는 다음 블록의 "이전 블록 해시"와 일치하지 않으므로 체인이 깨짐.
- **결과**: 블록체인은 데이터 위조 및 변조에 강함.

### 2) 블록 간 신뢰 연결
- 블록마다 "이전 블록의 해시"를 저장하여 체인 형태를 유지.
- 체인의 특정 블록이 변조되면, 이후 모든 블록의 해시 값이 변경되어 전체 체인이 무효화됨.
- **결과**: 블록체인은 탈중앙화된 환경에서 데이터 신뢰성을 확보.

### 3) 작업 증명(Proof of Work)
- 블록체인의 합의 알고리즘 중 하나로, 블록을 추가하려면 특정 조건을 만족하는 해시 값을 찾아야 함.
- **작업 과정**:
    1. 블록 데이터를 해싱하여 특정 난이도를 만족하는 해시 값이 나올 때까지 반복 계산.
    2. 이를 위해 **Nonce** 값을 변경하며 시도.
- **결과**: 작업 증명을 통해 네트워크의 합의와 보안을 보장.

---

## 4. Merkle Tree와 해시

블록 내 다수의 거래 데이터를 효율적으로 처리하고 검증하기 위해 **Merkle Tree**라는 구조를 사용합니다.

### Merkle Tree의 구조
- 각 거래 데이터를 해싱하여 **Leaf 노드**로 사용.
- Leaf 노드를 쌍(pair)으로 묶어 다시 해싱하여 상위 노드를 생성.
- 이를 반복하여 최종적으로 하나의 **루트 해시(Merkle Root)**를 생성.

### Merkle Tree의 특징
- **데이터 검증**: 특정 거래가 블록에 포함되었는지 빠르게 검증 가능.
- **효율성**: 모든 데이터를 하나의 루트 해시로 압축 가능.
- **무결성**: 데이터 일부가 변경되면 루트 해시도 변경되어 데이터 위조 탐지가 용이.

---

## 5. 해시 알고리즘의 선택 기준
블록체인에서 사용되는 해시 알고리즘은 다음 조건을 만족해야 합니다:
- **고속성**: 해시 계산이 빠르게 이루어져야 함.
- **고정 출력 길이**: 입력 데이터 크기와 관계없이 고정된 길이의 해시 값을 생성.
- **충돌 회피**: 서로 다른 입력 데이터가 동일한 해시 값을 가지지 않아야 함.
- **불가역성**: 해시 값을 통해 원래 데이터를 추정할 수 없어야 함.

### 블록체인에서 사용되는 주요 해시 알고리즘
| 알고리즘    | 특징                                | 사용 예                               |
|-------------|------------------------------------|---------------------------------------|
| SHA-256     | 256비트 해시 출력, 고속성, 높은 보안 | 비트코인, 이더리움                   |
| SHA-3       | 최신 해시 알고리즘, 향상된 보안성   | 일부 차세대 블록체인 프로젝트         |
| Blake2      | 빠르고 안전한 해시 알고리즘         | 암호화폐 **Zcash**, 일부 블록체인 구현 |

---

## 6. 블록체인에서 해시의 예시

### 블록 헤더 예제
```plaintext
Block Header:
{
    Previous Hash: "0000a3b1c...",
    Merkle Root: "f3b12d45...",
    Timestamp: "2024-11-14T10:00:00",
    Nonce: 459123,
    Difficulty: 4
}